Metadata-Version: 2.4
Name: babappalign
Version: 1.0.3
Summary: Deep learningâ€“based progressive multiple sequence alignment engine
Home-page: https://github.com/sinhakrishnendu/BABAPPAlign
Author: Krishnendu Sinha
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy
Requires-Dist: scipy
Requires-Dist: pandas
Requires-Dist: biopython
Requires-Dist: tqdm
Requires-Dist: torch
Requires-Dist: fair-esm
Dynamic: author
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: license-file
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.17934124.svg)](https://doi.org/10.5281/zenodo.17934124)

# BABAPPAlign

**BABAPPAlign** is a deep learningâ€“based **progressive multiple sequence alignment (MSA) engine** for protein sequences.
It integrates pretrained protein language model embeddings with a learned pairwise scoring function to improve alignment
accuracy while remaining **fully usable on CPU-only systems**.

> GPU acceleration is optional and used only for performance, not correctness.

---

## âœ¨ Key Features

- ğŸ§¬ Progressive multiple sequence alignment (MSA)
- ğŸ§  Learned pairwise scoring model (BABAPPAScore)
- ğŸ”¤ Uses pretrained **ESM2 residue embeddings**
- ğŸŒ³ UPGMA guide tree construction
- ğŸ“ Profileâ€“profile alignment with affine gap penalties
- ğŸ’» **Runs on CPU-only systems**
- ğŸš€ Optional GPU acceleration (auto-detected)
- â™»ï¸ Cached embeddings for fast, repeated runs
- ğŸ“¦ Distributed via **Bioconda**

---

## ğŸ“¦ Installation

### Install from Bioconda (recommended)

```bash
conda install -c bioconda babappalign
```

This installs a **CPU-compatible version**. No GPU or CUDA is required.

---

## ğŸš€ Quick Start

### Basic usage

```bash
babappalign input.fasta > output.aln.fasta
```

### Explicit output file

```bash
babappalign input.fasta --out output.aln.fasta
```

---

## ğŸ§  How BABAPPAlign Works

1. **Embedding generation**  
   Protein sequences are converted into residue-level embeddings using ESM2.

2. **Pairwise scoring**  
   A learned neural network model computes pairwise similarity scores between residues.

3. **Guide tree construction**  
   UPGMA is used to build a guide tree from learned distances.

4. **Progressive alignment**  
   Profiles are aligned using dynamic programming with affine gap penalties.

---

## â™»ï¸ Cached Embeddings

Embedding generation is computationally expensive. BABAPPAlign therefore **caches embeddings on disk**
and reuses them automatically.

### First run

```bash
babappalign input.fasta
```

### Subsequent runs

```bash
babappalign input.fasta --embedding-dir embeddings/
```

Cached embeddings can be generated once on a GPU machine and reused on any computer.

---

## ğŸ’» CPU vs GPU Execution

| Component | CPU | GPU |
|---------|-----|-----|
| MSA logic | âœ… | âœ… |
| Pairwise scoring | âœ… | âœ… |
| Guide tree | âœ… | âœ… |
| Progressive alignment | âœ… | âœ… |
| Embedding generation | âš ï¸ Slow | ğŸš€ Fast |

Alignment accuracy is identical on CPU and GPU.

---

## ğŸ“‚ Input Requirements

- Protein sequences only
- FASTA format
- No strict length or count limit (performance depends on hardware)

---

## ğŸ›  Command-Line Options

```bash
babappalign --help
```

Common options:
- `--out FILE` : output alignment file
- `--embedding-dir DIR` : use cached embeddings
- `--cpu-only` : force CPU execution

---

## ğŸ“œ License

MIT License. See the `LICENSE` file for details.

---

## ğŸ§¾ Citation

Manuscript in preparation.

---

## ğŸ‘¨â€ğŸ’» Author & Repository

- **Author:** Krishnendu Sinha  
- **GitHub:** https://github.com/sinhakrishnendu/BABAPPAlign  

---

**BABAPPAlign** is a portable, CPU-friendly MSA engine with optional GPU acceleration.
